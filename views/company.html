<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <style>
      thead input {
        width: 100%;
      }
    </style>
    <link
      rel="shortcut icon"
      type="image/ico"
      href="http://www.datatables.net/favicon.ico"
    />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, minimum-scale=1.0, user-scalable=no"
    />
    <title>Editor example - Basic initialisation</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/buttons/1.6.5/css/buttons.dataTables.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/select/1.3.1/css/select.dataTables.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="../css/editor.dataTables.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="./resources/syntax/shCore.css"
    />
    <link rel="stylesheet" type="text/css" href="./resources/demo.css" />
    <style type="text/css" class="init"></style>
    <script
      type="text/javascript"
      language="javascript"
      src="https://code.jquery.com/jquery-3.5.1.js"
    ></script>
    <script
      type="text/javascript"
      language="javascript"
      src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"
    ></script>
    <script
      type="text/javascript"
      language="javascript"
      src="https://cdn.datatables.net/buttons/1.6.5/js/dataTables.buttons.min.js"
    ></script>
    <script
      type="text/javascript"
      language="javascript"
      src="https://cdn.datatables.net/select/1.3.1/js/dataTables.select.min.js"
    ></script>
    <script
      type="text/javascript"
      language="javascript"
      src="../js/dataTables.editor.min.js"
    ></script>
    <script
      type="text/javascript"
      language="javascript"
      src="./resources/syntax/shCore.js"
    ></script>
    <script
      type="text/javascript"
      language="javascript"
      src="./resources/demo.js"
    ></script>
    <script
      type="text/javascript"
      language="javascript"
      src="./resources/editor-demo.js"
    ></script>
    <script type="text/javascript" language="javascript" class="init">
      var editor; // use a global for the submit and return data rendering in the examples

      $(document).ready(function () {
        editor = new $.fn.dataTable.Editor({
          ajax: "/api/list",
          table: "#example",
          fields: [
            {
              label: "Signname:",
              name: "signname",
            },
            {
              label: "Name:",
              name: "name",
            },
            {
              label: "Phone:",
              name: "phone",
            },
            {
              label: "Position:",
              name: "position",
            },
            {
              label: "Tel:",
              name: "tel",
            },
            {
              label: "Created_at:",
              name: "created_at",
              type: "datetime",
            },
            // {
            //   label: "Updated_at:",
            //   name: "updated_at",
            //   type: "datetime",
            // },
          ],
        });
        // 항목별 검색기능
        $("#example thead tr")
          .clone(true)
          .addClass("filters")
          .appendTo("#example thead");

        $("#example").DataTable(
          {
            orderCellsTop: true,
            fixedHeader: true,
            initComplete: function () {
              var api = this.api();

              // For each column
              api
                .columns()
                .eq(0)
                .each(function (colIdx) {
                  // Set the header cell to contain the input element
                  var cell = $(".filters th").eq(
                    $(api.column(colIdx).header()).index()
                  );
                  var title = $(cell).text();
                  $(cell).html(
                    '<input type="text" placeholder="' + title + '" />'
                  );

                  // On every keypress in this input
                  $(
                    "input",
                    $(".filters th").eq($(api.column(colIdx).header()).index())
                  )
                    .off("keyup change")
                    .on("change", function (e) {
                      // Get the search value
                      $(this).attr("title", $(this).val());
                      var regexr = "({search})"; //$(this).parents('th').find('select').val();

                      var cursorPosition = this.selectionStart;
                      // Search the column for that value
                      api
                        .column(colIdx)
                        .search(
                          this.value != ""
                            ? regexr.replace(
                                "{search}",
                                "(((" + this.value + ")))"
                              )
                            : "",
                          this.value != "",
                          this.value == ""
                        )
                        .draw();
                    })
                    .on("keyup", function (e) {
                      e.stopPropagation();

                      $(this).trigger("change");
                      $(this)
                        .focus()[0]
                        .setSelectionRange(cursorPosition, cursorPosition);
                    });
                });
            },
            // 항목별 검색기능 끝.

            dom: "Bfrtip",
            ajax: "/api/list",
            columns: [
              // { data: null, render: function ( data, type, row ) {
              // 	// Combine the first and last names into a single table field
              // 	return data.first_name+' '+data.last_name;
              // } },
              { data: "name" },
              { data: "signname" },
              { data: "phone" },
              { data: "position" },
              { data: "tel" },
              { data: "created_at" },
              //   { data: "updated_at" },
            ],
            select: true,
            buttons: [
              { extend: "create", editor: editor, text: "등록" },
              { extend: "edit", editor: editor, text: "수정" },
              { extend: "remove", editor: editor, text: "삭제" },
            ],
          },
          function () {
            console.log("확인ㅇ");
          }
        );
      });
    </script>
  </head>
  <body class="dt-example node">
    <div class="container">
      <section>
        <h1>Editor example <span>Basic initialisation</span></h1>
        <div class="info"></div>
        <div class="demo-html">
          <table id="example" class="display" style="width: 100%">
            <thead>
              <tr>
                <th>이름</th>
                <th>이메일</th>
                <th>휴대전화</th>
                <!-- <th>회사명</th> -->
                <th>직위/직급</th>
                <!-- <th>부서</th> -->
                <th>사내 전화번호</th>
                <th>가입일</th>
                <!-- <th>수정일</th> -->
                <!-- <th>Salary</th> -->
              </tr>
            </thead>
          </table>
        </div>
      </section>
    </div>
  </body>
</html>
